{% extends 'topics/base.html' %}

{% load i18n %}
{% load uni_form %}
{% load pagination_tags %}
{% load group_tags %}

{% block extra_head %}
    {{ block.super }}
    
    <link rel="alternate" type="application/rss+xml" title="myEWB Front Page" href="{% url topic_feed "all" %}" />
	<link rel="stylesheet" href="{{ STATIC_URL }}css/toolbars.css" />    
{% endblock %}

{% block head_title %}{% trans "Search" %}{% endblock %}

{% block body %}
    <h2>Search</h2>

    <form method="get" action=".">
        <table>
            {{ form.as_table }}
            <tr>
                <td>&nbsp;</td>
                <td>
                    <input type="submit" value="Search">
                </td>
            </tr>
        </table>

        {% if query %}
            <h3>Results</h3>
			{% if page.object_list %}
			    {% autopaginate page.object_list 10 %}
    
	            {% for result in page.object_list %}
	            	{# is there a better way? #}
	            	{% ifequal result.model_name "grouptopic" %}
					    {% with result.object as topic %}
					        {% include "topics/topic_item.html" %}
					    {% endwith %}
					{% else %}
		                <p>
		                    <a href="{{ result.object.get_absolute_url }}">{{ result.object.title }}</a>
		                </p>
		            {% endifequal %}
	            {% endfor %}

			    {% paginate %}

            {% else %}
                <p>No results found.</p>
            {% endif %}
        {% else %}
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
    </form>
{% endblock %}
